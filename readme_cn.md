#  SJM to Shell 脚本转换工具

## 开发目的
- 该脚本转换工具的开发目的是为了在本地环境中运行原本使用 SJM 任务投递的流程。由于一些流程需要在没有搭建任务投递环境的情况下按照 SJM 中 job 的先后顺序执行，因此编写了这个工具。

## 功能
- 使用纯 Python 编写，能够自动解析 SJM 文件，并将其转换为等效的 Shell 脚本输出。
- 主要使用拓扑排序算法来确定 SJM 中 job 的执行顺序。
- 两种执行方式：
    - 单步顺序执行： 按照 SJM 中 job 的 order 顺序逐步执行。
    - 非依赖关系的并行执行： 对于不具有依赖关系的 job，可以并行执行，提高整个流程的效率。


## 如何使用
- Demo的流程为生物信息学中一段常用的流程，为了方便大家阅读流程的顺序，在每个cmd的路径上做了序号标注，最终生成的结果shell文件内容可以根据序号来确认顺序。

```
  python sjm_to_shell.py -i demo.sjm -o demo_11.sh -f fun_11 -s bash

    # -i sjm 文件名 
    # -o 输出的 shell 文件名 
    # -f 选择输出 shell 文件使用单通道顺序执行(fun_1) 或 并行顺序执行(fun_11)
    # -s 选择输出 shell 文件(sh) 或 bash 文件(bash)
	
```

 
## 存在的问题和待优化
- 目前存在的问题:
    - 在并行执行中，如果某个 job 包含本身就是并行执行的程序（如 bwa -mem），可能会导致内存空间不足的情况。需要额外判断并处理这种情况。
- 性能优化：
    - 针对大型流程，进一步优化算法和代码，提高转换和执行效率。
- 通过不断的反馈和改进，期望使这个脚本转换工具更加稳定、灵活和易用。